load(paste("rdata/Zindex_",dataset,"_3_incomplete.RData",sep=""))
chau.res = res
chau.zindex = zindex
dataset = "BTM"
load(paste("rdata/Sil_",dataset,"_3_SS_Incomplete.RData",sep=""))
load(paste("rdata/Zindex_",dataset,"_3_incomplete.RData",sep=""))
btm.res = res
btm.zindex =zindex
rm(res,zindex)
library(reshape2)
ssname <- c("Ganesan","LC","PS",
"Zhou","Resnik","Lin","Nunivers","DF","AIC")
chau.despreciate = names(which(is.na(chau.res$average$silhouette[,1])==T))
btm.despreciate = names(which(is.na(btm.res$average$silhouette[,1])==T))
chau.zindex= chau.zindex[!(row.names(chau.zindex) %in% chau.despreciate),]
colnames(chau.zindex)  = ssname
btm.zindex= btm.zindex[!(row.names(btm.zindex) %in% btm.despreciate),]
colnames(btm.zindex)  = ssname
chau.bp <- boxplot_graphics(chau.zindex,ylab="Z-index",title = "(A)",k=1,cond = 1,ylim = c(0,0.8))
chau.bp
btm.bp <-  boxplot_graphics(btm.zindex,ylab="Z-index",title = "(B)",k=1,cond = 1,ylim = c(0,0.8))
library(gridExtra)
tiff(filename = paste(resFile,"Fig6.tiff",sep=""),pointsize = 12,
width = 2250,height=1125,res=300,compression = "lzw")
grid.arrange(chau.bp,btm.bp, ncol=2, nrow = 1)
dev.off()
chau.SilAvg = chau.res$average$silhouette
chau.SilAvg = chau.SilAvg[!(row.names(chau.SilAvg) %in% chau.despreciate),]
colnames(chau.SilAvg)  = ssname
chau.SilAvg = chau.res$average$silhouette
colnames(chau.SilAvg)
ssname
chau.SilAvg
chau.res
load(paste("rdata/Sil_",dataset,"_3_SS_Incomplete.RData",sep=""))
boxplot_graphics<-function(visites,title = "",xlab ="",ylab,ylim=c(0,1), k=1,cond=0){
require(ggplot2)
require(reshape2)
mdf <- melt(visites)
print(head(mdf))
lines = "#1F3552"
#Fill pour changer le coulours
fill=c("#DCDCDC")
ggplot(mdf, aes(x = Var2, y=value))+
stat_boxplot(geom="errorbar")+
geom_boxplot(colour = "black",fill=fill,alpha=1,outlier.color = "black", outlier.shape = 20)+
geom_hline(aes(yintercept=0.25), linetype="dashed",size=cond*k)  +
ylab(ylab)+ylim(ylim[1],ylim[2])+
scale_x_discrete(name=xlab) +
ggtitle(title)+theme(axis.text.x = element_text(family ="sans",hjust = 1,angle = 45),
axis.line.x=element_line(size=0.5*k, colour="black"),
axis.line.y = element_line(size=0.5*k,colour="black"),
axis.line = element_line(size=1,colour="black"),
axis.title = element_text(size=10),
axis.title.y = element_text(family ="sans",margin = margin(0,20,0,0)),
axis.title.x = element_text(family ="sans",margin = margin(20,0,0,0)),
axis.text = element_text(family ="sans",size=10),
#panel.grid.major = element_blank(),
# panel.grid.minor = element_blank(),
# panel.border = element_blank(),
panel.background = element_blank(),
plot.title = element_text(family ="sans",size=10,hjust = -0.25, vjust=2.12,margin = margin(5,0,40,0)))
}
dataset = "Chaussabel"
load(paste("rdata/Sil_",dataset,"_3_SS_Incomplete.RData",sep=""))
load(paste("rdata/Zindex_",dataset,"_3_incomplete.RData",sep=""))
chau.res = res
chau.zindex = zindex
dataset = "BTM"
load(paste("rdata/Sil_",dataset,"_3_SS_Incomplete.RData",sep=""))
load(paste("rdata/Zindex_",dataset,"_3_incomplete.RData",sep=""))
btm.res = res
btm.zindex =zindex
rm(res,zindex)
chau.SilAvg = chau.res$average$silhouette
chau.SilAvg = chau.SilAvg[!(row.names(chau.SilAvg) %in% chau.despreciate),]
colnames(chau.SilAvg)  = ssname
chau.SilAvg
chau.res
load("/home/aaron/git/geneSetAnnotation/results/rdata/Sil_Chaussabel_3_SS_Incomplete.RData")
View(res)
View(res)
View(res)
load("/home/aaron/git/geneSetAnnotation/results/rdata/Sil_BTM_3_SS_Incomplete.RData")
load(paste("rdata/Sil_",dataset,"_3_SS_Incomplete.RData",sep=""))
chau.res = res
chau.SilAvg = chau.res$average$silhouette
chau.SilAvg
chau.SilAvg = chau.SilAvg[!(row.names(chau.SilAvg) %in% chau.despreciate),]
dataset = "Chaussabel"
load(paste("rdata/Sil_",dataset,"_3_SS_Incomplete.RData",sep=""))
load(paste("rdata/Zindex_",dataset,"_3_incomplete.RData",sep=""))
chau.res = res
chau.zindex = zindex
dataset = "BTM"
load(paste("rdata/Sil_",dataset,"_3_SS_Incomplete.RData",sep=""))
load(paste("rdata/Zindex_",dataset,"_3_incomplete.RData",sep=""))
btm.res = res
btm.zindex =zindex
rm(res,zindex)
library(reshape2)
ssname <- c("Ganesan","LC","PS",
"Zhou","Resnik","Lin","Nunivers","DF","AIC")
chau.despreciate = names(which(is.na(chau.res$average$silhouette[,1])==T))
btm.despreciate = names(which(is.na(btm.res$average$silhouette[,1])==T))
chau.zindex= chau.zindex[!(row.names(chau.zindex) %in% chau.despreciate),]
colnames(chau.zindex)  = ssname
btm.zindex= btm.zindex[!(row.names(btm.zindex) %in% btm.despreciate),]
colnames(btm.zindex)  = ssname
chau.bp <- boxplot_graphics(chau.zindex,ylab="Z-index",title = "(A)",k=1,cond = 1,ylim = c(0,0.8))
chau.bp
btm.bp <-  boxplot_graphics(btm.zindex,ylab="Z-index",title = "(B)",k=1,cond = 1,ylim = c(0,0.8))
library(gridExtra)
tiff(filename = paste(resFile,"Fig6.tiff",sep=""),pointsize = 12,
width = 2250,height=1125,res=300,compression = "lzw")
grid.arrange(chau.bp,btm.bp, ncol=2, nrow = 1)
dev.off()
chau.SilAvg = chau.res$average$silhouette
chau.SilAvg = chau.SilAvg[!(row.names(chau.SilAvg) %in% chau.despreciate),]
colnames(chau.SilAvg)  = ssname
load(paste("rdata/Sil_",dataset,"_3_SS_Incomplete.RData",sep=""))
load(paste("rdata/Zindex_",dataset,"_3_incomplete.RData",sep=""))
chau.res = res
chau.zindex = zindex
dataset = "BTM"
load(paste("rdata/Sil_",dataset,"_3_SS_Incomplete.RData",sep=""))
load(paste("rdata/Zindex_",dataset,"_3_incomplete.RData",sep=""))
btm.res = res
btm.zindex =zindex
rm(res,zindex)
library(reshape2)
ssname <- c("Ganesan","LC","PS",
"Zhou","Resnik","Lin","Nunivers","DF","AIC")
chau.despreciate = names(which(is.na(chau.res$average$silhouette[,1])==T))
btm.despreciate = names(which(is.na(btm.res$average$silhouette[,1])==T))
chau.zindex= chau.zindex[!(row.names(chau.zindex) %in% chau.despreciate),]
colnames(chau.zindex)  = ssname
btm.zindex= btm.zindex[!(row.names(btm.zindex) %in% btm.despreciate),]
colnames(btm.zindex)  = ssname
chau.bp <- boxplot_graphics(chau.zindex,ylab="Z-index",title = "(A)",k=1,cond = 1,ylim = c(0,0.8))
chau.bp
btm.bp <-  boxplot_graphics(btm.zindex,ylab="Z-index",title = "(B)",k=1,cond = 1,ylim = c(0,0.8))
library(gridExtra)
tiff(filename = paste(resFile,"Fig6.tiff",sep=""),pointsize = 12,
width = 2250,height=1125,res=300,compression = "lzw")
grid.arrange(chau.bp,btm.bp, ncol=2, nrow = 1)
dev.off()
chau.SilAvg = chau.res$average$silhouette
chau.SilAvg = chau.SilAvg[!(row.names(chau.SilAvg) %in% chau.despreciate),]
colnames(chau.SilAvg)  = ssname
chau.sil.bp <- boxplot_graphics(chau.SilAvg,ylab="Average silhouette width",k=1,cond=0)
btm.SilAvg = btm.res$average$silhouette
btm.SilAvg = btm.SilAvg[!(row.names(btm.SilAvg) %in% btm.despreciate),]
colnames(btm.SilAvg)  = ssname
btm.sil.bp <- boxplot_graphics(btm.SilAvg,ylab="Average silhouette width",k=1,cond=0)
tiff(filename = paste(resFile,"Fig7.tiff",sep=""),pointsize = 12,
width = 2250,height=1125,res=300,compression = "lzw")
resFile = "visualization/"
grid.arrange(chau.sil.bp,btm.sil.bp, ncol=2, nrow = 1)
dev.off()
tiff(filename = paste(resFile,"Fig7.tiff",sep=""),pointsize = 12,
width = 2250,height=1125,res=300,compression = "lzw")
grid.arrange(chau.sil.bp,btm.sil.bp, ncol=2, nrow = 1)
dev.off()
chau.sil.bp <- boxplot_graphics(chau.SilAvg,ylab="Average silhouette width",,title = "(A)",k=1,cond=0)
btm.SilAvg = btm.res$average$silhouette
btm.SilAvg = btm.SilAvg[!(row.names(btm.SilAvg) %in% btm.despreciate),]
colnames(btm.SilAvg)  = ssname
btm.sil.bp <- boxplot_graphics(btm.SilAvg,ylab="Average silhouette width",,title = "(B)",k=1,cond=0)
tiff(filename = paste(resFile,"Fig7.tiff",sep=""),pointsize = 12,
width = 2250,height=1125,res=300,compression = "lzw")
grid.arrange(chau.sil.bp,btm.sil.bp, ncol=2, nrow = 1)
dev.off()
chau.cophCom <- chau.res$complete$cophenetic
chau.cophCom <- chau.cophCom[!(row.names(chau.cophCom) %in% chau.despreciate),]
chau.cophCom = chau.cophCom[,c(2:8,1,9)]
chau.cophSin <- chau.res$single$cophenetic
chau.cophSin <- chau.cophSin[!(row.names(chau.cophSin) %in% chau.despreciate),]
chau.cophSin = chau.cophSin[,c(2:8,1,9)]
chau.cophAvg <- chau.res$average$cophenetic
chau.cophAvg <- chau.cophAvg[!(row.names(chau.cophAvg) %in% chau.despreciate),]
chau.cophAvg = chau.cophAvg[,c(2:8,1,9)]
colnames(chau.cophCom) = colnames(chau.cophSin) = colnames(chau.cophAvg)  = ssname
chau.cophCom[is.na(chau.cophCom)==TRUE] = chau.cophSin[is.na(chau.cophSin)==TRUE] = chau.cophAvg[is.na(chau.cophAvg)==TRUE]  = 0
chau.bxCom <- boxplot_graphics(chau.cophCom,title="CLHM",title = "(A)",ylab="CCC",k=1)
chau.bxSin <- boxplot_graphics(chau.cophSin,title="SLHM",ylab="CCC",k=1)
chau.bxAvg <- boxplot_graphics(chau.cophAvg,title="ALHM",ylab="CCC",k=1)
btm.cophCom <- btm.res$complete$cophenetic
chau.cophCom <- chau.res$complete$cophenetic
chau.cophCom <- chau.cophCom[!(row.names(chau.cophCom) %in% chau.despreciate),]
chau.cophCom = chau.cophCom[,c(2:8,1,9)]
chau.cophSin <- chau.res$single$cophenetic
chau.cophSin <- chau.cophSin[!(row.names(chau.cophSin) %in% chau.despreciate),]
chau.cophSin = chau.cophSin[,c(2:8,1,9)]
chau.cophAvg <- chau.res$average$cophenetic
chau.cophAvg <- chau.cophAvg[!(row.names(chau.cophAvg) %in% chau.despreciate),]
chau.cophAvg = chau.cophAvg[,c(2:8,1,9)]
colnames(chau.cophCom) = colnames(chau.cophSin) = colnames(chau.cophAvg)  = ssname
chau.cophCom[is.na(chau.cophCom)==TRUE] = chau.cophSin[is.na(chau.cophSin)==TRUE] = chau.cophAvg[is.na(chau.cophAvg)==TRUE]  = 0
chau.bxCom <- boxplot_graphics(chau.cophCom,title="CLHM",ylab="CCC",k=1)
chau.bxSin <- boxplot_graphics(chau.cophSin,title="SLHM",ylab="CCC",k=1)
chau.bxAvg <- boxplot_graphics(chau.cophAvg,title="ALHM",ylab="CCC",k=1)
btm.cophCom <- btm.res$complete$cophenetic
btm.cophCom <- btm.cophCom[!(row.names(btm.cophCom) %in% btm.despreciate),]
btm.cophCom = btm.cophCom[,c(2:8,1,9)]
btm.cophSin <- btm.res$single$cophenetic
btm.cophSin <- btm.cophSin[!(row.names(btm.cophSin) %in% btm.despreciate),]
btm.cophSin = btm.cophSin[,c(2:8,1,9)]
btm.cophAvg <- btm.res$average$cophenetic
btm.cophAvg <- btm.cophAvg[!(row.names(btm.cophAvg) %in% btm.despreciate),]
btm.cophAvg = btm.cophAvg[,c(2:8,1,9)]
colnames(btm.cophCom) = colnames(btm.cophSin) = colnames(btm.cophAvg)  = ssname
btm.cophCom[is.na(btm.cophCom)==TRUE] = btm.cophSin[is.na(btm.cophSin)==TRUE] = btm.cophAvg[is.na(btm.cophAvg)==TRUE]  = 0
btm.bxCom <- boxplot_graphics(btm.cophCom,title="CLHM",ylab="CCC",k=1)
btm.bxSin <- boxplot_graphics(btm.cophSin,title="SLHM",ylab="CCC",k=1)
btm.bxAvg <- boxplot_graphics(btm.cophAvg,title="ALHM",ylab="CCC",k=1)
tiff(filename = paste(res,"Fig5.tiff",sep=""),pointsize = 5,
width = 2250,height=2250,res=300,compression = "lzw")
grid.arrange(chau.bxSin,chau.bxCom,chau.bxAvg,
btm.bxSin, btm.bxCom, btm.bxAvg,
ncol=3, nrow = 2)
dev.off()
tiff(filename = paste(resFile,"Fig5.tiff",sep=""),pointsize = 5,
width = 2250,height=2250,res=300,compression = "lzw")
grid.arrange(chau.bxSin,chau.bxCom,chau.bxAvg,
btm.bxSin, btm.bxCom, btm.bxAvg,
ncol=3, nrow = 2)
dev.off()
boxplot_graphics<-function(visites,title = "",xlab ="",ylab,ylim=c(0,1), k=1,cond=0){
require(ggplot2)
require(reshape2)
mdf <- melt(visites)
print(head(mdf))
lines = "#1F3552"
#Fill pour changer le coulours
fill=c("#DCDCDC")
ggplot(mdf, aes(x = Var2, y=value))+
stat_boxplot(geom="errorbar")+
geom_boxplot(colour = "black",fill=fill,alpha=1,outlier.color = "black", outlier.shape = 20)+
geom_hline(aes(yintercept=0.25), linetype="dashed",size=cond*k)  +
ylab(ylab)+ylim(ylim[1],ylim[2])+
scale_x_discrete(name=xlab) +
ggtitle(title)+theme(axis.text.x = element_text(family ="sans",hjust = 1,angle = 45),
axis.line.x=element_line(size=0.5*k, colour="black"),
axis.line.y = element_line(size=0.5*k,colour="black"),
axis.line = element_line(size=1,colour="black"),
axis.title = element_text(size=10),
axis.title.y = element_text(family ="sans",margin = margin(0,20,0,0)),
axis.title.x = element_text(family ="sans",margin = margin(20,0,0,0)),
axis.text = element_text(family ="sans",size=10),
#panel.grid.major = element_blank(),
# panel.grid.minor = element_blank(),
# panel.border = element_blank(),
panel.background = element_blank(),
plot.title = element_text(family ="sans",size=10,hjust = 0.5, text="bold",margin = margin(5,0,40,0)))
}
chau.cophCom <- chau.res$complete$cophenetic
chau.cophCom <- chau.cophCom[!(row.names(chau.cophCom) %in% chau.despreciate),]
chau.cophCom = chau.cophCom[,c(2:8,1,9)]
chau.cophSin <- chau.res$single$cophenetic
chau.cophSin <- chau.cophSin[!(row.names(chau.cophSin) %in% chau.despreciate),]
chau.cophSin = chau.cophSin[,c(2:8,1,9)]
chau.cophAvg <- chau.res$average$cophenetic
chau.cophAvg <- chau.cophAvg[!(row.names(chau.cophAvg) %in% chau.despreciate),]
chau.cophAvg = chau.cophAvg[,c(2:8,1,9)]
colnames(chau.cophCom) = colnames(chau.cophSin) = colnames(chau.cophAvg)  = ssname
chau.cophCom[is.na(chau.cophCom)==TRUE] = chau.cophSin[is.na(chau.cophSin)==TRUE] = chau.cophAvg[is.na(chau.cophAvg)==TRUE]  = 0
chau.bxCom <- boxplot_graphics(chau.cophCom,title="CLHM",ylab="CCC",k=1)
chau.bxSin <- boxplot_graphics(chau.cophSin,title="SLHM",ylab="CCC",k=1)
chau.bxAvg <- boxplot_graphics(chau.cophAvg,title="ALHM",ylab="CCC",k=1)
btm.cophCom <- btm.res$complete$cophenetic
boxplot_graphics<-function(visites,title = "",xlab ="",ylab,ylim=c(0,1), k=1,cond=0){
require(ggplot2)
require(reshape2)
mdf <- melt(visites)
print(head(mdf))
lines = "#1F3552"
#Fill pour changer le coulours
fill=c("#DCDCDC")
ggplot(mdf, aes(x = Var2, y=value))+
stat_boxplot(geom="errorbar")+
geom_boxplot(colour = "black",fill=fill,alpha=1,outlier.color = "black", outlier.shape = 20)+
geom_hline(aes(yintercept=0.25), linetype="dashed",size=cond*k)  +
ylab(ylab)+ylim(ylim[1],ylim[2])+
scale_x_discrete(name=xlab) +
ggtitle(title)+theme(axis.text.x = element_text(family ="sans",hjust = 1,angle = 45),
axis.line.x=element_line(size=0.5*k, colour="black"),
axis.line.y = element_line(size=0.5*k,colour="black"),
axis.line = element_line(size=1,colour="black"),
axis.title = element_text(size=10),
axis.title.y = element_text(family ="sans",margin = margin(0,20,0,0)),
axis.title.x = element_text(family ="sans",margin = margin(20,0,0,0)),
axis.text = element_text(family ="sans",size=10),
#panel.grid.major = element_blank(),
# panel.grid.minor = element_blank(),
# panel.border = element_blank(),
panel.background = element_blank(),
plot.title = element_text(family ="sans",size=10,hjust = 0.5, face="bold",margin = margin(5,0,40,0)))
}
chau.cophCom <- chau.res$complete$cophenetic
chau.cophCom <- chau.cophCom[!(row.names(chau.cophCom) %in% chau.despreciate),]
chau.cophCom = chau.cophCom[,c(2:8,1,9)]
chau.cophSin <- chau.res$single$cophenetic
chau.cophSin <- chau.cophSin[!(row.names(chau.cophSin) %in% chau.despreciate),]
chau.cophSin = chau.cophSin[,c(2:8,1,9)]
chau.cophAvg <- chau.res$average$cophenetic
chau.cophAvg <- chau.cophAvg[!(row.names(chau.cophAvg) %in% chau.despreciate),]
chau.cophAvg = chau.cophAvg[,c(2:8,1,9)]
colnames(chau.cophCom) = colnames(chau.cophSin) = colnames(chau.cophAvg)  = ssname
chau.cophCom[is.na(chau.cophCom)==TRUE] = chau.cophSin[is.na(chau.cophSin)==TRUE] = chau.cophAvg[is.na(chau.cophAvg)==TRUE]  = 0
chau.bxCom <- boxplot_graphics(chau.cophCom,title="CLHM",ylab="CCC",k=1)
chau.bxSin <- boxplot_graphics(chau.cophSin,title="SLHM",ylab="CCC",k=1)
chau.bxAvg <- boxplot_graphics(chau.cophAvg,title="ALHM",ylab="CCC",k=1)
btm.cophCom <- btm.res$complete$cophenetic
btm.cophCom <- btm.cophCom[!(row.names(btm.cophCom) %in% btm.despreciate),]
btm.cophCom = btm.cophCom[,c(2:8,1,9)]
btm.cophSin <- btm.res$single$cophenetic
btm.cophSin <- btm.cophSin[!(row.names(btm.cophSin) %in% btm.despreciate),]
btm.cophSin = btm.cophSin[,c(2:8,1,9)]
btm.cophAvg <- btm.res$average$cophenetic
btm.cophAvg <- btm.cophAvg[!(row.names(btm.cophAvg) %in% btm.despreciate),]
btm.cophAvg = btm.cophAvg[,c(2:8,1,9)]
colnames(btm.cophCom) = colnames(btm.cophSin) = colnames(btm.cophAvg)  = ssname
btm.cophCom[is.na(btm.cophCom)==TRUE] = btm.cophSin[is.na(btm.cophSin)==TRUE] = btm.cophAvg[is.na(btm.cophAvg)==TRUE]  = 0
btm.bxCom <- boxplot_graphics(btm.cophCom,title="CLHM",ylab="CCC",k=1)
btm.bxSin <- boxplot_graphics(btm.cophSin,title="SLHM",ylab="CCC",k=1)
btm.bxAvg <- boxplot_graphics(btm.cophAvg,title="ALHM",ylab="CCC",k=1)
tiff(filename = paste(resFile,"Fig5.tiff",sep=""),pointsize = 5,
width = 2250,height=2250,res=300,compression = "lzw")
grid.arrange(chau.bxSin,chau.bxCom,chau.bxAvg,
btm.bxSin, btm.bxCom, btm.bxAvg,
ncol=3, nrow = 2)
dev.off()
setwd(dirname(rstudioapi::getSourceEditorContext()$path))
setwd("../../results/")
resFile = "visualization/"
if(!dir.exists(resFile)){
dir.create(resFile)
}
##########################################################################################
#Chau
dataset = "Chaussabel"
t<- read.table(paste("newBriefings_Incomplete/",dataset,"_3/Analysis_Rep/genCoverture.csv",sep=""),header = T)
head(t)
##########################################################################################
#Chau
dataset = "Chaussabel"
t<- read.table(paste("newBriefings_Incomplete/",dataset,"_3/Analysis_Rep/genCoverture.csv",sep=""),header = T)
head(# Wed Sep 12 17:15:10 2018 ------------------------------)
)
head(t)
t<- read.table(paste("newBriefings_Incomplete/",dataset,"_3/Analysis_Rep/genCoverture.csv",sep=""),header = T)
head(t)
##########################################################################################
#Chau
dataset = "Chaussabel"
t<- read.table(paste("newBriefings_Incomplete/",dataset,"_3/Analysis_Rep/genCoverture.csv",sep=""),header = T)
head(t)
t<- read.table(paste("newBriefings_Incomplete/",dataset,"_3/Analysis_Rep/genCoverture.csv",sep=""),header = T)
head(t)
##########################################################################################
#Chau
dataset = "Chaussabel"
t<- read.table(paste("newBriefings_Incomplete/",dataset,"_3/Analysis_Rep/genCoverture.csv",sep=""),header = T)
head(t)
t
##########################################################################################
#Chau
dataset = "Chaussabel"
t<- read.table(paste("newBriefings_Incomplete/",dataset,"_3/Analysis_Rep/genCoverture.csv",sep=""),header = T)
t
##########################################################################################
#Chau
dataset = "Chaussabel"
t<- read.table(paste("newBriefings_Incomplete/",dataset,"_3/Analysis_Rep/genCoverture.csv",sep=""),header = T)
t
##########################################################################################
#Chau
dataset = "Chaussabel"
t<- read.table(paste("newBriefings_Incomplete/",dataset,"_3/Analysis_Rep/genCoverture.csv",sep=""),header = T)
t
##########################################################################################
#Chau
dataset = "Chaussabel"
t<- read.table(paste("newBriefings_Incomplete/",dataset,"_3/Analysis_Rep/genCoverture.csv",sep=""),header = T)
t
##########################################################################################
#Chau
dataset = "Chaussabel"
t<- read.table(paste("newBriefings_Incomplete/",dataset,"_3/Analysis_Rep/genCoverture.csv",sep=""),header = T)
lineplots <- function(t){
require(ggplot2)
k=1
l <- list()
count = 0
n = length(t$Module)/5
for(x in 1:5){
a <- 1 + count
if(x == 5){
b <- length(t$Module)
}else{
b <- n+ count
}
ccc <- t[a:b,]
count = count +n
l[[x]] <- ggplot(ccc, aes(x = Module, y=value,group = SS))+
geom_line(aes(linetype=SS, color = SS))+
ylim(0,100)+
scale_x_discrete("Chaussabel modules") +
scale_colour_grey( start = 0.2, end = 0.8, na.value = "red")+
#scale_y_continuous("Percentage of covered genes")+
theme(axis.text.x = element_text(hjust = 0.5),
axis.line.x=element_line(size=0.5*k, colour="black"),
axis.line.y = element_line(size=0.5*k,colour="black"),
axis.line = element_line(size=1,colour="black"),
axis.title = element_text(size=10*k),
axis.title.y = element_blank(), #element_text(margin = margin(0,20,0,0)),
axis.title.x =element_blank(), #element_text(margin = margin(20,0,0,0)),
axis.text = element_text(size=8*k),
#panel.grid.major = element_blank(),
# panel.grid.minor = element_blank(),
# panel.border = element_blank(),
legend.key = element_rect(fill = "white", colour = "white"),
legend.title = element_text(face = "bold"),
legend.title.align=0.5,
panel.background = element_blank(),
plot.margin = margin(t = 15, r = 15, b = 15, l = 15, unit = "pt"),
plot.title = element_text(size=25*k,hjust = 0.5,face="bold",margin = margin(5,0,40,0)))
}
library(gtable)
legend = gtable_filter(ggplotGrob(l[[1]]), "guide-box")
library(grid)
library(gridExtra)
grid.arrange(arrangeGrob(l[[1]]+ theme(legend.position="none"),
l[[2]] + theme(legend.position="none"),
l[[3]] + theme(legend.position="none"),
l[[4]]+ theme(legend.position="none"),
l[[5]] + theme(legend.position="none"),
nrow=5, ncol = 1),
left = textGrob("\nPercentage of genes", rot = 90, vjust = 1),
legend,
bottom = textGrob("Chaussabel modules"),
widths=unit.c(unit(0.95, "npc") - legend$width, legend$width ))
}
tiff(filename = "visualization/Figure_Chaussabel_Sup.tiff",pointsize = 12,
width = 8250,height=3250,res=400)
lineplots(t)
dev.off()
lineplots <- function(t){
require(ggplot2)
k=1
l <- list()
count = 0
n = length(t$Module)/5
for(x in 1:5){
a <- 1 + count
if(x == 5){
b <- length(t$Module)
}else{
b <- n+ count
}
ccc <- t[a:b,]
count = count +n
l[[x]] <- ggplot(ccc, aes(x = Module, y=value,group = SS))+
geom_line(aes(linetype=SS, color = SS))+
ylim(0,100)+
scale_x_discrete("Chaussabel modules") +
#scale_colour_grey( start = 0.2, end = 0.8, na.value = "red")+
#scale_y_continuous("Percentage of covered genes")+
theme(axis.text.x = element_text(hjust = 0.5),
axis.line.x=element_line(size=0.5*k, colour="black"),
axis.line.y = element_line(size=0.5*k,colour="black"),
axis.line = element_line(size=1,colour="black"),
axis.title = element_text(size=10*k),
axis.title.y = element_blank(), #element_text(margin = margin(0,20,0,0)),
axis.title.x =element_blank(), #element_text(margin = margin(20,0,0,0)),
axis.text = element_text(size=8*k),
#panel.grid.major = element_blank(),
# panel.grid.minor = element_blank(),
# panel.border = element_blank(),
legend.key = element_rect(fill = "white", colour = "white"),
legend.title = element_text(face = "bold"),
legend.title.align=0.5,
panel.background = element_blank(),
plot.margin = margin(t = 15, r = 15, b = 15, l = 15, unit = "pt"),
plot.title = element_text(size=25*k,hjust = 0.5,face="bold",margin = margin(5,0,40,0)))
}
library(gtable)
legend = gtable_filter(ggplotGrob(l[[1]]), "guide-box")
library(grid)
library(gridExtra)
grid.arrange(arrangeGrob(l[[1]]+ theme(legend.position="none"),
l[[2]] + theme(legend.position="none"),
l[[3]] + theme(legend.position="none"),
l[[4]]+ theme(legend.position="none"),
l[[5]] + theme(legend.position="none"),
nrow=5, ncol = 1),
left = textGrob("\nPercentage of genes", rot = 90, vjust = 1),
legend,
bottom = textGrob("Chaussabel modules"),
widths=unit.c(unit(0.95, "npc") - legend$width, legend$width ))
}
tiff(filename = "visualization/Figure_Chaussabel_Sup.tiff",pointsize = 12,
width = 8250,height=3250,res=400)
lineplots(t)
dev.off()
dataset = "BTM"
t<- read.table(paste("newBriefings_Incomplete/",dataset,"_3/Analysis_Rep/genCoverture.csv",sep=""),header = T)
tiff(filename = "visualization/Figure_BTM_Sup.tiff",pointsize = 12,
width = 8250,height=3250,res=400)
lineplots(t)
dev.off()
